# Role
- あなたは、ゲームデザイナ兼プログラマ兼コンポーザーAIアシスタントです。

# Purpose
- ピクロスゲームを作成します。

# Requirements and Specification

## Requirements
- 画面はスタイリッシュでカラフルで、シズル感のあるUIにします。
- 基本的なゲームのルールは一般的なピクロスゲームに従います。
- UIにはReactを使い、Web画面で提供します。

## Gamed design and specification

### Game Title
- elfpix

### Game system

#### プロローグ

- 概要
    - プロローグを表示する
- 画面表示
    - 背景画面 
        - 黒背景
    - プロローグ表示画面
        - ウィンドウ背景：青色
        - ウィンドウ枠：金色
        - 文字：白色
    - テキスト
        - 森深くに隠されたエルフの集落には、
        - 古から伝わる知恵遊び「elfpix」が存在した。
        - これは、森に宿る精霊の力を象った図形を浮かび上がらせる、
          まるでピクロスのような試練。
        - エルフは、森に迷い込んだ者にこの「elfpix」を課し、
        - 正しく解き明かした者だけが先へ進むことが許すという…。

#### オープニング

- 概要
    - 概要
        ゲーム開始・コンティニューを選択できる。
    - 内部情報
        - タイトル
            - elfpix
        - 背景
            - assets/img/* からランダムな画像を背景に表示
    - 表示
        - タイトル画面を表示する
        - 「**New Game**」ボタンを表示する
            - **New Game** を押下した場合
                - 今までのデータをクリアする。
                - クリアする前に「本当に削除してもよいですか？」を確認
                - 削除OKの場合
                    - 削除した上でゲーム開始
            - **Continue** を押下した場合
        - 「**Continue**」ボタン、を表示する
            - **Continue** を押下した場合
                - **ゲーム開始** へ遷移する。

#### ゲーム開始

- 会話ウィンドウを表示
    - テキスト
        - ここに一人の人間の若き旅人がいた。[Enter]
        - その名を…[Enter]
        - 会話ウィンドウ閉じる
    - """名前決定モード"""へ移動、名前決定後に、後ほどここに戻る
    - その名を「${HERO_NAME}」といった。
    - 森の奥に眠る「古代の泉」にたどり着くために、エルフの森へ足を踏み入れようとしていた。
    - しかし、エルフの守り人たちから「elfpix」の挑戦を突きつけられてしまう。
    - 主人公の知恵と洞察力が、森を抜ける唯一の鍵となる…。

#### 名前決定モード

- 概要
  - 名前入力画面を開き、名前入力を行う。
  - ここで決定した名前は、以降「${HERO_NAME}」として表示された箇所の具体値として利用される
- 画面
    - カタカナを横書きで並べてある
        - ア行～ナ行まで１列目
        - ハ行～ワ行まで２列目
        - 取り消しボタン
        - 決定ボタン
    - 背景画像
        - assets/img/* からランダムな画像を背景に表示
            - 透明度：60%
- 操作
    - 決定ボタン
        - 主人公の名前を入力値とする
          以降$${HERO_NAME}に、入力値を保存する
        - 名前入力画面を閉じる
    - 取り消しボタン
        - 文字を一文字削除する
        - １文字入力を戻す

#### ルートモード

- 概要
    - 主人公の旅路と現在値を示し、選択したルート上にあるノードにいるelfとピクロスバトルとなる。
    - そのルート上のどこに現在位置しており、どのように進行をするかを決定／見える化するためのモード。

- 内部データ表現
    - ルートにはノードとエッジがある。
    - ノード
        - ルート開始場所。
        - ルート修了場所。
        - エルフと遭遇する場所。
        - エルフと会話して、ピクロスバトルが開始される。
        - ピクロスモードに遷移する。ピクロスモード終了後にここに戻る。
    - ルート
        - ノードとノードをつなぐもの。
        - ノード同士にルートがある個所は、ノードを行き来可能
    - ルートとノードの表現
        - 以下のルートとノードを定義。このルートとノードを線と点でつなぐ
            - node:start
                - node: elf-practice
                    - node: elf-easy
                        - node: elf-middle
                            - node: ending-middle
                            - node: elf-hard
                        - node: elf-hard
                            - node: ending-hard
    - 現在地
        - 主人公が現在いる位置を示す
- 画面
    - ルートとノードが画面に表示されている
    - 主人公のノードの現在値に、デフォルメキャラを表示する
        - 画像
            - assets/img/character/hero/00083-826608146.pngを 表示
            - 縦：60px
            - 横：20px
    - 開始のノード位置に、スタート位置がわかるような画像を表示する
    - 終了のノード位置に、終了位置がわかるような画像を表示する
    - ルートは一本道の表現ではなく、気持ち曲がりくねったような形で道らしい表現で表示する
    - 背景画像
        - assets/img/* からランダムな画像を背景に表示
            - 透明度：60%
    - ノード
        - ノードの真下にテキストボックスを表示
            - テキストボックス内にノードの名称を表示
            - テキストボックス
                - 属性
                    - 背景:白
                    - 枠：黒
                    - フォント：黒
- 操作
    - ノードをクリック
            - クリックしたノードに主人公を移動させる
                - 移動元：主人公がいたノードの中心から
                - 移動先：クリックしたノードの中心まで
                - 移動の速度：素早く（0.5秒）移動
                - 移動のさせ方：ノード間のルートに沿った形で移動
                - 移動時にSE：移動のような音を再生
            -""ピクロスモード"" へ移行・開始
            - ""ピクロスモード"" から戻るまで待機
        - 制約
            - クリック可能なノードは、
              主人公が位置するノードから次のノードまでとする。
            - ２つ先のノードへは移動できない。
            - からなず１ノードのみとする
            - １ノード先であれば、ルートがつながっいれば
              どちらへでも移動が可能。
            - 移動したら元の位置に戻ることはできない。

#### ピクロスモード

- 概要
    - ピクロスを説くモード
    - ノードの位置別に相手キャラクターとお題（ピクロスのサイズ）が異なる
    - practice
        - ノードの対応
            - 名前:elf-practice
        - 対戦相手
            - ピクロスのサイズ
                - 5 x 5
            - 属性
                - 名前：リーネ
                - 設定・キャラクター概要：練習用の相手、道先案内人。
                - 画像（通常）：(test画像)
                - 画像（笑顔）：(test画像)
                - 画像（怒り）：(test画像)
    - easy
        - ノードとの対応
            - 名前:elf-easy
        - 対戦相手
            - ピクロスのサイズ
                - 10 x 10
            - 属性
                - 名前：エフィナ
                - 設定・キャラクター概要：森の中層で動物モチーフのパズル。
                - 画像（通常）：(test画像)
                - 画像（笑顔）：(test画像)
                - 画像（怒り）：(test画像)
    - middle
        - ノードとの対応
            - 名前: elf-middle
        - 対戦相手
            - ピクロスのサイズ
                - 15 x 15
            - 属性
                - 名前：セリス
                - 設定・キャラクター概要：奥地で古代紋章モチーフのパズル。
                - 画像（通常）：(test画像)
                - 画像（笑顔）：(test画像)
                - 画像（怒り）：(test画像)
    - hard
        - ノードとの対応
            - 名前: elf-hard
        - 対戦相手
            - ピクロスのサイズ
                - 20 x 20
            - 属性
                - 名前：フローリア
                - 設定・キャラクター概要：精霊を象るパズル、物語の核心に近づく。
                - 画像（通常）：(test画像)
                - 画像（笑顔）：(test画像)
                - 画像（怒り）：(test画像)
    - ultra
        - ノードの位置
            - elf-ultra
        - 対戦相手
            - ピクロスのサイズ
                - 25 x 25
            - 属性
                - 名前：アルティナ
                - 設定・キャラクター概要：最終試練、結末分岐。
                - 画像（通常）：(test画像)
                - 画像（笑顔）：(test画像)
                - 画像（怒り）：(test画像)

- 画面
    - 初期表示
        - 残り時間表示バー
        - ピクロス画面
            - ノードにあわせてピクロスを表示
            - **Continue** ボタン
            - **Quit** ボタン
            - **Submit** ボタン
            - ピクロスのヒント文字列は18pt程度にする
            - ピクロスの画面は75%程度の透明度にする
            - ピクロスの画面は表示画面の上下左右から常にセンタリングする
            - ヒント文字列はピクロスの１マスサイズと等間隔で並べる
            - ヒント文字列は、行は右揃え、列は下揃えにする
        - 背景画像
            - assets/img/* からランダムな画像を背景に表示
                - 透明度：60%
- 操作
    - **Submit** を押下する
        - ピクロス終了状態へ移行する

    - **Quit** を押下する
        - ゲームオーバーモードへ移行する

- タイマー処理
    - ピクロス開始状態直後から、持ち時間が減少する
    - 0秒になった場合に、ピクロス終了状態に線にする

- 内部データ・状態
    - ピクロス開始状態
        - 初期状態は20分持ち時間がある
    - ピクロス終了状態
        - 終了時のピクロスの回答と答案が一致している場合
            - 「Mission clear！」を表示する
            - ノードモードへ移行する
        - 終了時のピクロスの状態と回答が一致してい無い場合
            - 一致していない場合は「Failed」と表示しする
            - ゲームオーバーモードに移行する

### ゲームオーバーモード

- 概要
    ゲームオーバーを示し、ゲームオーバー後の行動予定を決める

- 画面
    - 初期表示画面
        - **Continue** ボタン
        - **Quit** ボタン
        - 背景画像
            - assets/img/* からランダムな画像を背景に表示
- 操作
    - **Continue** ボタンを押下
        - 再度、同じキャラクター・ノードに挑戦できる
        - ゲームの時間を20分に戻す
    - **Quit** ボタンを押下
        - ゲームオーバーの音楽を流す
        - ゲームオーバーである旨を表示する

### 共通

- 画面
    - 「サウンド」ボタンを配置
        - ボタンの表示名称は「BGM」
        - ボタンのスタイル
            - サウンド再生状態 == true
                - グリーン
            - サウンド再生状態 == false
                - 灰色
- 内部データ
    - デフォルト：サウンドオフ
- 操作
    - 「サウンド」ボタン押下
        - サウンド再生状態がfalseの場合
            - サウンドオン
            - audioタグを用いて、assets/img/* からランダムな音楽を再生
        - サウンド再生状態がtrueの場合
            - サウンドオフ
        - サウンドオン状態
            - バックグラウンドで再生され続ける
            - 画面遷移しても再生され続ける    

### Game sound
#### Sound Effect
- 塗った場合は、筆で塗った時のような音を鳴らします。
- 「保留」「×」等可能性のあるマークを塗るときは、別の音をならします。

# Control Codex
- Commitする際に、バージョンについては提案をしてください。基本的にマイナーバージョンを一つ上げます。
- 変更点をコミットする際に差分を教えてください。差分をユーザが確認し・承認されたら、コミット・Pushしてください。ユーザが承認しなかった場合は、承認されなかった理由の入力を待ち、入力に基づき修正を行います。
- コミットメッセージは"[modified]<<バージョン名>> <<変更内容>>"とします。変更内容はCodexで修正したTODの内容を記載します。
- Commitと同時にタグも付与します。

