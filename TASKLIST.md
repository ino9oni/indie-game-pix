# Idea Memo

**このセクションはアイディアを書き止めておく場所です**
**このセクションに記載の内容を実装したい場合は、TASKやBUGに移動させますので、このセクションに記載の内容はすべて保留にしてください**
**ただし、将来的に記載のような変更が入る可能性があるため、そのような変更にも対応可能なような変更容易性を加味した内部設計を心がけるようにしてください**

- リスクとリターンを考える

  - アイディアリスト：
    - 何故そのゲームが面白いと感じるのか
      - ゲーム性を上げると一般性が落ちる
        - ゲーム性
          - リスクとリターン
            - 自分がコンボを貯めると、相手の邪魔ができる
              - 邪魔のレベルを制御できる
                - 05コンボ　ー＞　２つランダムで元に戻す
                - 10コンボ　ー＞　４つランダムで元に戻す
                - 15コンボ　ー＞　６つランダムで元に戻す
                - 20コンボ　ー＞　８つランダムで元に戻す
                - 25コンボ　ー＞１０つランダムで相手のピクロスモードを元に戻す
              - ただしコンボを狙い過ぎると、時間がかかるので相手がクリア―してしまう可能性が高まる
        - カジュアル性
          - ルールは簡単、誰でも知っている、チュートリアルを設ける
          - 基本は、ボードのサイズを大きすぎないようにしてとにかくお題をクリアーすることを楽しむ（５ｘ５）
        - ターゲット層　
          - ピクロスをあまり知らない層
          - ピクロスは何となくわかっているが難しいことを考えずに楽しみたい層
          - エルフのキャラクターを楽しみたい・好きな層

- 桜井さんの教え・Tips
  - プレイヤーを楽しませることを優先する
  - ゲーム性とはリスクとリターンが本質
  - 何故そのゲームが面白いと感じるのか＝ゲーム性
  - ゲーム性を上げると一般性が落ちる
    - ゲーム性がゲームのすべてではない
  - 何かの仕様を入れる場合に、相反する要素を入れる
  - ストレス、解消、成長、進展　を意識する
  - 遊びの本質４つ　

- ご褒美
  - 実績アンロック

- ピクロスモードで下段に表示されるメッセージウィンドウを削除する
  - 背景：各キャラクターがスペルを唱えた時のメッセージウィンドウがすでにあるので不要なため

- マップモードから会話モードへ移動する際のエフェクトの変更
  - 背景
    - エフェクトの表示が、マップのサイズに収まってしまっている
    - これを、マップのサイズではなく、画面全体に表示したい
  - 変更：
    - マップのレイヤーより上にエフェクトを持ってきて、画面全体に広がるように変更
    - 会話モードはそのエフェクトが終了したら左からHERO,右からENEMYが現れるように表示

- ゲームのコントローラで、以下の操作を可能にする
  - プロローグモード
    - 決定ボタン：Nextボタンの操作
  - オープニングモード
    - 上下ボタン：NewGameかContinueを選択できる
    - 決定ボタン：
  - 名前決定モード
    - 上下左右ボタン：カーソルの移動
  - ゲームのコントローラでの操作時の表示仕様
    - コントローラで操作している場合はフォーカスが当たっていることを表示すること
      - 例：ボタンを決定する場合、そのボタンをフォーカスすること
  - ゲームのコントローラでの操作時のその他仕様
    - どのゲームモードでも統一感のある操作となるようにする
      - 例：どのモードでも、決定ボタンは常に同じ、キャンセルボタンは常に同じ
      - 例：決定ボタンは「OK、Next、Continue」等、キャンセルボタンは「Skip」など

- ピクロスモード時の難易度を軟化させる
  - 背景：
    - SOLVERを導入し、5x5であっても、非対称性が加わることで難しくなりすぎて、PRACTICEやEASYの敵に勝つことができなくなったためこれを軟化させたい
    - ピクロスモードがPRACTICEやEASYぐらいまでは、対称性がある方がわかりやすいと思うのでそのようにする
  - 変更内容：
    - 以下のピクロスモードについては、解の一意性を保ちつつ、回答の対象が左右対称上下対象のものにする
    - 可能であれば何らかを意味する形にする（スマイル、矢印、ハートなど）

# Dev Task TODO
## Priority: high
- [done] ENEMYが勝利した際にはのHEROの敗北画面を表示する
  - ENEMY側が先にすべてのお題をクリアーした場合、「${HERO_NAME} LOSE」を表示する
    - 表情表示のアセット
      - 表示画像：public/assets/img/character/hero/hero_lose.png
    - 表示文言
      - 「${HERO_NAME} LOSE」を表示する
    - サウンド：
      敗北感のある曲を流す
- [done] 後半のENEMY（MIDDLE,HARD,ULTRA）の盤面のサイズを変更する
  - 背景：ピクロスの盤面サイズが大きすぎてプレイに時間がかかる
  - 変更：ピクロスの盤面のサイズを小さくする、その代わりにお題の数を増やす
    - 盤面のサイズ指定：
      - MIDDLE : 5 x 5
      - HIGH : 10 x 10
      - ULTRA : 10 x 10
    - お題数の指定
      - MIDDLE : 5
      - HIGH : 3
      - ULTRA : 5
- [done] お題を動的に毎回変更・シャッフルする
  - 毎回プレイ毎に、動的に生成されたお題は必ず解くことができる
  - お題そのものは、相手と同じでよいが、相手と異なるお題の順序にする
  - 出来た回答は何らかの意味ある形の画像となるように生成する
    - その上で、ピクロスのルールを満たす形であるとする
    - 解は常に１つで、解くことができる答案とする（ヒントが無さ過ぎまたは多過ぎて解けないことがないようなお題を生成する）
    - 左右対称は可能な限り避ける
- [done] チュートリアルモードの背景画像の変更
  - 概要：チュートリアルモードの背景画像を変更する
  - 仕様：
    - 背景画像：public/assets/img/background/tutorial_bg.png
- [done] 勝利画面の背景画像の変更
  - 概要：勝利画面の背景画像を変更する
  - 仕様：
    - 背景画像：public/assets/img/background/win_bg.png
- [done] チュートリアルとプラクティスの追加
  - 概要：ピクロスについて詳しくないプレイヤー向けにルールを説明する
  - 背景：ピクロスを知らないユーザは、ルールを知らずにプレイできないため、チュートリアルを作成したい
  - 変更点：
    - UIの変更
      - オープニング画面に「チュートリアル（Tutorial）」ボタンを追記する
        - 追加位置：NewGame　の上側
    - 動作の変更
      - Tutorialボタンを押下した場合、Tutorialモードへ移行
    - チュートリアルモード
      - 左側に解説用のキャラクターの画像（未定）を表示する
      - 右側にサンプルのピクロス盤面を表示する
      - 下段に説明用のウィンドウを表示する
    - チュートリアルの進行
      - 以下の順番で説明し、実際に自動で操作を行い視覚的に理解を促す、説明中は次へボタンで説明が進行する
        - ピクロスのゴールについて説明
          - ピクロスの盤面でFilled対象のところをすべてFilledにできればクリアーとなります
          - カーソルを当てて、右クリックを押下することで、Filledにすることができます
        - ピクロスのヒントについての説明
          - ピクロスの盤面の行列部分に数字があることを説明
          - この数字の意味について説明
            - 例として１２１がある場合
              - １つ連なるFilledと
              - 間があり
              - ２つ連なるFilledと
              - 間があり
              - 最後に１つ連なるFilledがあることを説明
              - 必ず、数字と数字の間には一つ以上の間があることを説明
          - ピクロスの攻略について説明
            - 大きな数字から埋めていく
            - Maybe（×）マークを付けて、可能性がないところには×を入れておく
            - 行が５マスのピクロスで、ヒントに３とあった場合
              - 左から３マス、右から３マスどちらからFilledになったと仮定した場合
              　必ず中央の３つ目はFilledになる場合はFilledとしてマークすることが可能
          - すべてのチュートリアルが終了した後、オープニング画面に戻る
- [done] 主人公の名前のデフォルト値で「セリア」に変更
  - 名前入力モードで入力するHEROの名前は「セリア」に設定
- [done] ピクロスゲーム勝利時のSEの変更
  - ピクロスゲーム勝利モード時に鳴らすSEを以下のSEファイルに変更する
    - 再生１回のみ
    - 利用ファイル:public/assets/bgm/indie-game-fanfare.wav
      - アプリケーションに記載するパスは./assetから始まるように記載
- [done] ピクロス対戦時のBGMの変更
  - ピクロス対戦時に鳴らすBGMを以下のBGMファイルに変更する
    - 再生繰り返し
    - 利用ファイル:public/assets/bgm/indie-game-pix-battle5.wav
      - アプリケーションに記載するパスは./assetから始まるように記載
- [done] ゲームのコントローラーを利用可能にする
  - USBで接続しているゲームのコントローラ―を利用可能にする
- [done] コンボ表示を入れる
  - 連続で正解のFilledが発生した場合に、Filledの正解が途切れるまで、コンボ表示を行う
    - コンボ表示はスペル表示枠に表示する
- スペルの攻撃エフェクトをもっと派手目のエフェクトに変更する
  - 例：スペル発動時炎や水などの属性の爽快感のある攻撃エフェクトにする
- [done] マップモードのノード表示の表示をもう少しクォータービューで立体的に表現
  - 右にエッジとノードが伸びている物を右斜め奥に進むような表現に変更
- [done] 会話モードの時の背景画像をENEMYの画像に差し替える
  - 背景画像：assets/img/character/enemies/<level>/<enemyname>_fullbody.png
- [done] 会話モードのキャラクターの表示サイズを、縦横1.5倍にする
  - ただし、ブラウザのウインドウサイズに合わせてサイズは変化する
- [done] バトルモードの背景画像をENEMYの画像に差し替える
  - 背景画像：assets/img/character/enemies/<level>/<enemyname>_fullbody.png
- [done] バトルモード時のBGMが再生されないので修正する
  - ファイル：assets\bgm\indie-game-pix-battle.wav
- [done] ピクロスモードで、Filledしたマスがすべて回答と一致している場合は次のお題にすぐに遷移する
- [done] ピクロスモードのお題クリア時の挙動を変更する
  - 仕様
    - 各プレイヤー（HERO,ENEMY）の、お題がすべてFilledして完成した後、次々に次のお題に遷移するが、相手側が未完成の場合は、相手側はそのままの状態にします
    - あくまで、Filledして完成した側だけを、次のお題にすすめます
    - HEROのお題がすべてFilledして完成した場合、HEROだけ次のお題に進むことができる
    - その際、ENEMYの状態はそのままで、ENEMY側は次のお題に進ませないようにする
    - ENEMY側も同様で、ENEMY側のお題がすべてFilledして完成した場合、ENEMY側だけ次のお題に進むことができる
    - その際、HERO側の状態はそのままで、HERO側は次のお題に進ませないようにする
    - 次のお題に遷移する際に、スコアのカウントアップを待たずに遷移します。
- [done] オープニングモードと名前入力モード時の背景画像はHEROの全身画像を利用する
  - 背景画像：public/assets/img/character/hero/hero_fullbody.png
- [done] オープニングから名前入力画面まで、同じBGMを再生する
  - モードの変化時も音楽が途切れないように再生したままとする
- [done] Quitボタンを押下した、または、ゲームオーバーとなった後に再度最初からプレイする場合、オープニングモードに遷移
  - オープニングモードのBGMを再度再生する
- [done] バトルモード時のBGMが再生されないので修正する
  - ファイル：assets\bgm\indie-game-pix-battle.wav
- [done] バトルモードで敵にもスコアを付与する
  - バトルモードでHEROのスコア表示位置をHERO側のスペルの右端に記載する、スぺル表示と重複しないようにしつつ、HEROの側のレイアウトに収まるようにする
  - バトルモードでENEMYのスコア表示位置をENEMY側のスペルの右端に記載する、スぺル表示と重複しないようにしつつ、ENEMY側のレイアウトに収まるようにする
  - 既存のスコアは表示不要とする
- [done] ピクロスモードで表示されている、クリア数の枠のサイズがやや大きいので、スペル枠の上下高さと揃える

# Issues and Bugs

## Priority: high
- HERO側が操作していない場合、ENEMY側の操作が止まる不具合を修正する
  - HERO側が操作している時のみ、ENEMY側の操作が動作する状態のため、HERO側の操作をしていない場合でも、ENEMYのペースでお題を解いて行けるようにする
- オープニングモードでBGMをオフにした後、Startボタンを押下するとまたBGMがオンになる
  - オープニングモードでBGMをオフにした後は、ユーザの操作を行わない限りはBGMをオンにしないように修正する
- タイマー処理に不具合があるものを修正
  - タイマーがカウントダウンしないため、カウントダウンをするように修正
- 主人公の名前決定モード前後の会話ウィンドウの表示位置の上部を固定する
- [done] ピクロスモードで「ｘ」（Maybe）を入力すると、盤面で表示が上下にずれる問題の改善
  - ピクロスモードで「ｘ」を入力した際に、マス目に収まるように表示する
- [done] 名前入力画面前の背景を差し替え
  - ファイル：public/assets/img/character/hero/hero_fullbody.png
- [done] 名前入力画面後の背景を差し替え
  - ファイル：public/assets/img/character/hero/hero_fullbody.png
- [done] トータルスコアの表示位置は常に画面の一番右上に他のボタンと同程度のサイズで配置
- [done] タイトル画面の背景を差し替える
  - ファイル：assets/img/title.png

## Priority: normal

# Improvement
## Priority: normal
- [done] 勝利画面のデザインや文言の改良
  - 変更前：
    - スロットのボード名が「Symbol Code」になっている
    - スロットのボードのレイアウトが 横8、縦4になっている
  - 変更後：
    - スロットのボード名を「Elfpix Symbol」に変更する
    - スロットのボードのレイアウトが 横5、縦6に変更する
- [done] 勝利画面のデザインの改善（screenクラスの変更）
  - 背景：
    勝利画面のscreenレイアウトに含まれるmax-widthが子要素のレイアウト崩れを発生させているのでこれを修正
  - 変更後：
    勝利画面の.screenクラスのmax-heightを除外する
- [done] 勝利画面のレイアウトの改善
  - 背景：
    - 勝利画面のレイアウトが崩れている
  - 変更前：
    - HEROの画像と勝利メッセージのレイアウトと、ボードのレイアウトと、アンロックレイアウトが同じレイアウト内に表示されている
    - ボードの各記号のレイアウトが縦長で押しつぶされている
  - 変更後：
    - HEROの画像と勝利メッセージのレイアウトと、ボードのレイアウトと、アンロックレイアウトをそれぞれ別のレイアウトして、左上にHEROレイアウト、左下にアンロックレイアウト、右側はボードレイアウトで並べる
    - ボードの各記号のピクロスボード部分のサイズ分は記号表示枠の幅を確保する
    - ボードの各記号のピクロスボード部分内のパディングは0.2px程度にする
    - ボードの各記号のレイアウトの左右同士を1pxずつパディングする
    - ボードの各記号から、レベルと日付を省き、記号の名称だけを入れる
    - ボードの各記号から、レベルに合わせた背景色を入れる
      - PRACTICE：透明薄緑
      - EASY：透明薄青
      - MIDDLE：透明薄紫
      - HARD：透明薄赤
      - ULTRA：透明薄黒
- [done] ピクロスモード時の全HEROとENEMYのピクロスボードサイズを 5ｘ5 に変更
  - 背景：
    - お題のサイズが10x10等になると急に時間がかかり始めてしまい、スピード感、爽快感が少なくなりカジュアル性がなくなる
    - そのため小さいサイズの物を素早く説いていくスピード感、爽快感等のカジュアル性を重視する
    - その代わり今後ゲーム性（駆け引き、リスクリターン）も増強する
  - 変更内容：
    - 変更前：
      - 各ENEMYとHEROのピクロスボードサイズがレベルアップの度にサイズアップする
    - 変更後：
      - 各ENEMYとHEROのピクロスボードサイズをすべて5x5に変更する

- [done] ピクロスモードのお題の出し方の変更と、記号化と、コレクション要素の追加
  - 背景：
    - お題を意味不明な形にするのではなく、記号的形及び文字的な意味を与えつつピクロスとして一意に解が定まるものとし、最終的にそれらを収集して
      Endingを迎えるというストーリーに結節させて、ストーリー性はもとより、コレクター要素と、達成感をゲームに付与する
  - 変更内容：
    - PRACTICE,EASY,MIDDLE,HARD,ULTRAの各出題されるお題の数を以下に変更する
      - PRACTICE : 2
      - EASY : 4
      - MIDDLE : 6
      - HARD : 8
      - ULTRA : 10
    - 勝利画面で、HERO WINのレイアウトを左に寄せる
    - 勝利画面で、文字盤が一つずつ埋まるような木目調の四角いボードを用意する（30個の穴がある）して右側に寄せる
    - 各レベルでクリアしたお題で現れた記号を、そのボードに勝利時に答えと共に埋めていく
      （例：＠という記号文字が仮に回答だったとして、文字盤のピースをはめる下段の回答欄に「＠」と表示する）

- ピクロスモードで駆け引き要素を強化する
  - 背景
    現状のスペルはスペル自体が発動するが、あまり駆け引き的要素がつよくなく、リスクを取るというより流れ作業の延長になっている
    これを、ローリスクローリターン、ハイリスクハイリターンとなるような変更を行い、ゲーム性を強化する
  - 変更前：
    - スペルを５段階用意する
    - スペルの名称はキャラクターの特性から適当に作成する
    - スペルの５段階目の効果は、相手のぼ
  - 変更後：
    - 自分がコンボを貯めると、相手の邪魔ができる
      - 邪魔のレベルを制御できる
        - 05コンボ　ー＞　ランダムに選択した横１列の回答を未回答状態に戻す
        - 10コンボ　ー＞　ランダムに選択した縦と横の１列の回答を未回答状態に戻す
        - 15コンボ　ー＞　ランダムに選択した縦と横の２列を未回答状態に戻す
        - 20コンボ　ー＞　ランダムに選択した縦と横の２列と、斜め（／）を未回答状態に戻す
        - 25コンボ　ー＞　ランダムに選択した縦と横の２列と、斜め（＼）と斜め（／）を未回答状態に戻す
      - ただしコンボを狙い過ぎると、時間がかかるので相手がクリア―してしまう可能性が高まる
      - 相手の邪魔をする際には、邪魔がされているというエフェクトをオーバレイして表現する 
        - 例：縦一列を凍らせる、もしくは炎で焼く、もしくはブラインドにする、雷を落とす、など

- 時間切れの場合の表示の変更 
  - 背景：
    - 時間切れとなった場合の表示が適切ではないのでこれを変更する
  - 変更後：
    - HEROの敗北画面を表示しつつ時間切れのである旨を表示する
    - 時間切れにならないためのヒントやTipsを表示する
    - Again（再チャレンジ）か、Quit（諦めるか）のボタンを表示する
      - Again押下時：再度ピクロスモードで同ENEMYと対戦再開する
      - Quit押下時：BadEndingを表示し、オープニング画面に遷移する


- [done] ピクロスモード時の画面下段のメッセージエリアを削除
  - 背景：
    - HERO,ENEMIESそれぞれがメッセ―ジを発するウィンドウがすでにあるので不要になったため
- 敗北画面のキャラクターの表示が小さく見えるため、これを大きくする
  - 背景
    - タスクタイトルの通り
  - 変更
    - キャラクターの表示を勝利画面と同じサイズに変戸数る
- [done] スペルを唱える時のフォントを変更する
  - 変更：
    - 丸みを帯びたかわいいフォントを選ぶ
    - 初る
    - フォントのサイズを200%にする
- [done] 勝利画面のキャラクターにかかるレイヤーの変更
    - 概要：勝利画面のキャラクター表示エリアに半透明のレイヤーがあるように見えるためこれを削除する
        勝利画面でははっきりとキャラクターを表示させる
    - 仕様：
        キャラクターの表示画像レイヤーを他のレイヤー上に移動させる
- 画像や音楽のダウンロードに時間がかかっていて処理が重いので最初に全部ダウンロードしておきキャッシュする
  - 背景：ゲームプレイ中に画像や音楽のダウンロードを行うとフリーズするため、事前にリソース情報をダウンロードしておきたい
  - 改善内容：画像や音楽のリソース群をあらかじめダウンロードし、ダウンロードしたものを利用することでユーザレスポンスを高速化する
  - 仕様：
    - ダウンロードのタイミング
      - オープニングモード時
      - プロローグモード時
      - チュートリアルモード時
      - 名前入力モード時
      - 会話モード時
    - ダウンロードしたファイルの保存
      - ローカルキャッシュまたはローカルストレージに保存
- 会話モードのキャラクターの表示領域の背景を半透明にする
  - 透過率:60%
  - 対象:HEROと全ENEMYの両方
- [done] 会話モードのENEMY側の背景色を変更する
  - 背景色: 黄色
- [done] assetsにあるファイルを、階層構造そのままに、public/assetsに移動させる
  - そのあと、アプリケーションで呼び出しているパスを以下を満たすように変更する
    - localhostで起動した場合とGithub Pagesにデプロイした後に起動するアプリ内で
      両方とも同じパスで読み込みが可能であること
- [done] ピクロスボードの枠線の視認性が悪いので改善する
  - 枠線の透明度を下げる もしくは 枠線を立体的もしくは背景像が見えなくならない程度に枠に色を付ける
- [done] 会話モードで、キャラクターの画像の位置が互いに近すぎるので、それぞれ左右に寄せる、左右過ぎず、中央過ぎず
- [done] 会話モードのキャラクター画像が大きすぎるので、縦横の比率はそのままにサイズを0.75倍程度にする
- [done] ピクロスモードでのキャラクター・スペル・スコア・ピクロスのパネルの高さの位置をウィンドウの中央に来るように配置
  - HEROとENEMYどちらも同じ高さに変更
- [done] マップモードでENEMY Encounterdした時のエフェクトを以下に変更する
